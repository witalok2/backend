{"remainingRequest":"/home/witalo/go/src/github.com/witalok2/application/frontend/node_modules/babel-loader/lib/index.js!/home/witalo/go/src/github.com/witalok2/application/frontend/node_modules/quasar/src/mixins/virtual-scroll.js","dependencies":[{"path":"/home/witalo/go/src/github.com/witalok2/application/frontend/node_modules/quasar/src/mixins/virtual-scroll.js","mtime":499162500000},{"path":"/home/witalo/go/src/github.com/witalok2/application/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/witalo/go/src/github.com/witalok2/application/frontend/node_modules/babel-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _defineProperty from \"/home/witalo/go/src/github.com/witalok2/application/frontend/node_modules/@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport \"core-js/modules/es6.number.constructor\";\nimport debounce from \"../utils/debounce.js\";\nimport frameDebounce from \"../utils/frame-debounce.js\";\nvar aggBucketSize = 1000;\n\nfunction sumFn(acc, h) {\n  return acc + h;\n}\n\nfunction getScrollDetails(parent, child, beforeRef, afterRef, horizontal, stickyStart, stickyEnd) {\n  var parentCalc = parent === window ? document.scrollingElement || document.documentElement : parent,\n      propElSize = horizontal === true ? 'offsetWidth' : 'offsetHeight',\n      details = {\n    scrollStart: 0,\n    scrollViewSize: -stickyStart - stickyEnd,\n    scrollMaxSize: 0,\n    offsetStart: -stickyStart,\n    offsetEnd: -stickyEnd\n  };\n\n  if (horizontal === true) {\n    if (parent === window) {\n      details.scrollStart = window.pageXOffset || window.scrollX || document.body.scrollLeft || 0;\n      details.scrollViewSize += window.innerWidth;\n    } else {\n      details.scrollStart = parentCalc.scrollLeft;\n      details.scrollViewSize += parentCalc.clientWidth;\n    }\n\n    details.scrollMaxSize = parentCalc.scrollWidth;\n  } else {\n    if (parent === window) {\n      details.scrollStart = window.pageYOffset || window.scrollY || document.body.scrollTop || 0;\n      details.scrollViewSize += window.innerHeight;\n    } else {\n      details.scrollStart = parentCalc.scrollTop;\n      details.scrollViewSize += parentCalc.clientHeight;\n    }\n\n    details.scrollMaxSize = parentCalc.scrollHeight;\n  }\n\n  if (beforeRef !== void 0) {\n    for (var el = beforeRef.previousElementSibling; el !== null; el = el.previousElementSibling) {\n      details.offsetStart += el[propElSize];\n    }\n  }\n\n  if (afterRef !== void 0) {\n    for (var _el = afterRef.nextElementSibling; _el !== null; _el = _el.nextElementSibling) {\n      details.offsetEnd += _el[propElSize];\n    }\n  }\n\n  if (child !== parent) {\n    var parentRect = parentCalc.getBoundingClientRect(),\n        childRect = child.getBoundingClientRect();\n\n    if (horizontal === true) {\n      details.offsetStart += childRect.left - parentRect.left;\n      details.offsetEnd -= childRect.width;\n    } else {\n      details.offsetStart += childRect.top - parentRect.top;\n      details.offsetEnd -= childRect.height;\n    }\n\n    if (parent !== window) {\n      details.offsetStart += details.scrollStart;\n    }\n\n    details.offsetEnd += details.scrollMaxSize - details.offsetStart;\n  }\n\n  return details;\n}\n\nfunction setScroll(parent, scroll, horizontal) {\n  if (parent === window) {\n    if (horizontal === true) {\n      window.scrollTo(scroll, window.pageYOffset || window.scrollY || document.body.scrollTop || 0);\n    } else {\n      window.scrollTo(window.pageXOffset || window.scrollX || document.body.scrollLeft || 0, scroll);\n    }\n  } else {\n    parent[horizontal === true ? 'scrollLeft' : 'scrollTop'] = scroll;\n  }\n}\n\nfunction sumSize(sizeAgg, size, from, to) {\n  if (from >= to) {\n    return 0;\n  }\n\n  var lastTo = size.length,\n      fromAgg = Math.floor(from / aggBucketSize),\n      toAgg = Math.floor((to - 1) / aggBucketSize) + 1;\n  var total = sizeAgg.slice(fromAgg, toAgg).reduce(sumFn, 0);\n\n  if (from % aggBucketSize !== 0) {\n    total -= size.slice(fromAgg * aggBucketSize, from).reduce(sumFn, 0);\n  }\n\n  if (to % aggBucketSize !== 0 && to !== lastTo) {\n    total -= size.slice(to, toAgg * aggBucketSize).reduce(sumFn, 0);\n  }\n\n  return total;\n}\n\nexport default {\n  props: {\n    virtualScrollHorizontal: Boolean,\n    virtualScrollSliceSize: {\n      type: Number,\n      default: 30\n    },\n    virtualScrollItemSize: {\n      type: Number,\n      default: 24\n    },\n    virtualScrollStickySizeStart: {\n      type: Number,\n      default: 0\n    },\n    virtualScrollStickySizeEnd: {\n      type: Number,\n      default: 0\n    }\n  },\n  data: function data() {\n    return {\n      virtualScrollSliceRange: {\n        from: 0,\n        to: 0\n      }\n    };\n  },\n  watch: {\n    virtualScrollHorizontal: function virtualScrollHorizontal() {\n      this.__setVirtualScrollSize();\n    }\n  },\n  methods: {\n    scrollTo: function scrollTo(toIndex) {\n      var scrollEl = this.__getVirtualScrollTarget();\n\n      if (scrollEl === void 0 || scrollEl === null || scrollEl.nodeType === 8) {\n        return;\n      }\n\n      this.__setVirtualScrollSliceRange(scrollEl, getScrollDetails(scrollEl, this.__getVirtualScrollEl(), this.$refs.before, this.$refs.after, this.virtualScrollHorizontal, this.virtualScrollStickySizeStart, this.virtualScrollStickySizeEnd), Math.min(this.virtualScrollLength - 1, Math.max(0, parseInt(toIndex, 10) || 0)), 0, this.prevToIndex > -1 && toIndex > this.prevToIndex ? 'end' : 'start');\n    },\n    __onVirtualScrollEvt: function __onVirtualScrollEvt() {\n      var scrollEl = this.__getVirtualScrollTarget();\n\n      if (scrollEl === void 0 || scrollEl === null || scrollEl.nodeType === 8) {\n        return;\n      }\n\n      var scrollDetails = getScrollDetails(scrollEl, this.__getVirtualScrollEl(), this.$refs.before, this.$refs.after, this.virtualScrollHorizontal, this.virtualScrollStickySizeStart, this.virtualScrollStickySizeEnd),\n          scrollMaxStart = scrollDetails.scrollMaxSize - Math.max(scrollDetails.scrollViewSize, scrollDetails.offsetEnd),\n          listLastIndex = this.virtualScrollLength - 1;\n\n      if (this.prevScrollStart === scrollDetails.scrollStart) {\n        return;\n      }\n\n      this.prevScrollStart = void 0;\n\n      if (scrollMaxStart > 0 && scrollDetails.scrollStart >= scrollMaxStart) {\n        this.__setVirtualScrollSliceRange(scrollEl, scrollDetails, this.virtualScrollLength - 1, scrollMaxStart - this.virtualScrollSizesAgg.reduce(sumFn, 0));\n\n        return;\n      }\n\n      var toIndex = 0,\n          listOffset = scrollDetails.scrollStart - scrollDetails.offsetStart;\n\n      for (var j = 0; listOffset >= this.virtualScrollSizesAgg[j] && toIndex < listLastIndex; j++) {\n        listOffset -= this.virtualScrollSizesAgg[j];\n        toIndex += aggBucketSize;\n      }\n\n      while (listOffset > 0 && toIndex < listLastIndex) {\n        listOffset -= this.virtualScrollSizes[toIndex];\n        toIndex++;\n      }\n\n      this.__setVirtualScrollSliceRange(scrollEl, scrollDetails, toIndex, listOffset);\n    },\n    __setVirtualScrollSliceRange: function __setVirtualScrollSliceRange(scrollEl, scrollDetails, toIndex, offset, align) {\n      var _this = this;\n\n      var from = Math.max(0, Math.ceil(toIndex - (align === void 0 ? 3 : 2) * this.virtualScrollSliceSizeComputed / 6)),\n          to = from + this.virtualScrollSliceSizeComputed;\n\n      if (to > this.virtualScrollLength) {\n        to = this.virtualScrollLength;\n        from = Math.max(0, to - this.virtualScrollSliceSizeComputed);\n      }\n\n      this.__emitScroll(toIndex);\n\n      var rangeChanged = from !== this.virtualScrollSliceRange.from || to !== this.virtualScrollSliceRange.to;\n\n      if (rangeChanged === false && align === void 0) {\n        return;\n      }\n\n      if (rangeChanged === true) {\n        this.virtualScrollSliceRange = {\n          from: from,\n          to: to\n        };\n        this.virtualScrollPaddingBefore = sumSize(this.virtualScrollSizesAgg, this.virtualScrollSizes, 0, from);\n        this.virtualScrollPaddingAfter = sumSize(this.virtualScrollSizesAgg, this.virtualScrollSizes, to, this.virtualScrollLength);\n      }\n\n      this.$nextTick(function () {\n        if (rangeChanged === true) {\n          var contentEl = _this.$refs.content;\n\n          if (contentEl !== void 0) {\n            var children = contentEl.children;\n\n            for (var i = children.length - 1; i >= 0; i--) {\n              var index = from + i,\n                  diff = children[i][_this.virtualScrollHorizontal === true ? 'offsetWidth' : 'offsetHeight'] - _this.virtualScrollSizes[index];\n\n              if (diff !== 0) {\n                _this.virtualScrollSizes[index] += diff;\n                _this.virtualScrollSizesAgg[Math.floor(index / aggBucketSize)] += diff;\n              }\n            }\n          }\n        }\n\n        var posStart = _this.virtualScrollSizes.slice(from, toIndex).reduce(sumFn, scrollDetails.offsetStart + _this.virtualScrollPaddingBefore),\n            posEnd = posStart + _this.virtualScrollSizes[toIndex];\n\n        var scrollPosition = posStart + offset;\n\n        if (align !== void 0) {\n          scrollPosition = scrollDetails.scrollStart < posStart && posEnd < scrollDetails.scrollStart + scrollDetails.scrollViewSize ? scrollDetails.scrollStart : align === 'end' ? posEnd - scrollDetails.scrollViewSize : posStart;\n        }\n\n        _this.prevScrollStart = scrollPosition;\n\n        _this.__setScroll(scrollEl, scrollPosition, _this.virtualScrollHorizontal);\n      });\n    },\n    __resetVirtualScroll: function __resetVirtualScroll(toIndex) {\n      var _this2 = this;\n\n      var defaultSize = this.virtualScrollItemSize;\n\n      if (Array.isArray(this.virtualScrollSizes) === false) {\n        this.virtualScrollSizes = [];\n      }\n\n      var oldVirtualScrollSizesLength = this.virtualScrollSizes.length;\n      this.virtualScrollSizes.length = this.virtualScrollLength;\n\n      for (var i = this.virtualScrollLength - 1; i >= oldVirtualScrollSizesLength; i--) {\n        this.virtualScrollSizes[i] = defaultSize;\n      }\n\n      var jMax = Math.floor((this.virtualScrollLength - 1) / aggBucketSize);\n      this.virtualScrollSizesAgg = [];\n\n      for (var j = 0; j <= jMax; j++) {\n        var size = 0;\n        var iMax = Math.min((j + 1) * aggBucketSize, this.virtualScrollLength);\n\n        for (var _i = j * aggBucketSize; _i < iMax; _i++) {\n          size += this.virtualScrollSizes[_i];\n        }\n\n        this.virtualScrollSizesAgg.push(size);\n      }\n\n      this.prevToIndex = -1;\n      this.prevScrollStart = void 0;\n\n      if (toIndex >= 0) {\n        this.$nextTick(function () {\n          _this2.scrollTo(toIndex);\n        });\n      } else {\n        this.virtualScrollPaddingBefore = sumSize(this.virtualScrollSizesAgg, this.virtualScrollSizes, 0, this.virtualScrollSliceRange.from);\n        this.virtualScrollPaddingAfter = sumSize(this.virtualScrollSizesAgg, this.virtualScrollSizes, this.virtualScrollSliceRange.to, this.virtualScrollLength);\n\n        this.__onVirtualScrollEvt();\n      }\n    },\n    __setVirtualScrollSize: function __setVirtualScrollSize() {\n      if (this.virtualScrollHorizontal === true) {\n        this.virtualScrollSliceSizeComputed = typeof window === 'undefined' ? this.virtualScrollSliceSize : Math.max(this.virtualScrollSliceSize, Math.ceil(window.innerWidth / this.virtualScrollItemSize * 2));\n      } else {\n        this.virtualScrollSliceSizeComputed = typeof window === 'undefined' ? this.virtualScrollSliceSize : Math.max(this.virtualScrollSliceSize, Math.ceil(window.innerHeight / this.virtualScrollItemSize * 2));\n      }\n    },\n    __padVirtualScroll: function __padVirtualScroll(h, tag, content) {\n      var paddingSize = this.virtualScrollHorizontal === true ? 'width' : 'height';\n      return [tag === 'tbody' ? h(tag, {\n        staticClass: 'q-virtual-scroll__padding',\n        key: 'before',\n        ref: 'before'\n      }, [h('tr', [h('td', {\n        style: _defineProperty({}, paddingSize, \"\".concat(this.virtualScrollPaddingBefore, \"px\")),\n        attrs: {\n          colspan: '100%'\n        }\n      })])]) : h(tag, {\n        staticClass: 'q-virtual-scroll__padding',\n        key: 'before',\n        ref: 'before',\n        style: _defineProperty({}, paddingSize, \"\".concat(this.virtualScrollPaddingBefore, \"px\"))\n      }), h(tag, {\n        staticClass: 'q-virtual-scroll__content',\n        key: 'content',\n        ref: 'content'\n      }, content), tag === 'tbody' ? h(tag, {\n        staticClass: 'q-virtual-scroll__padding',\n        key: 'after',\n        ref: 'after'\n      }, [h('tr', [h('td', {\n        style: _defineProperty({}, paddingSize, \"\".concat(this.virtualScrollPaddingAfter, \"px\")),\n        attrs: {\n          colspan: '100%'\n        }\n      })])]) : h(tag, {\n        staticClass: 'q-virtual-scroll__padding',\n        key: 'after',\n        ref: 'after',\n        style: _defineProperty({}, paddingSize, \"\".concat(this.virtualScrollPaddingAfter, \"px\"))\n      })];\n    },\n    __emitScroll: function __emitScroll(index) {\n      if (this.prevToIndex !== index) {\n        this.$listeners['virtual-scroll'] !== void 0 && this.$emit('virtual-scroll', {\n          index: index,\n          from: this.virtualScrollSliceRange.from,\n          to: this.virtualScrollSliceRange.to - 1,\n          direction: index < this.prevToIndex ? 'decrease' : 'increase'\n        });\n        this.prevToIndex = index;\n      }\n    }\n  },\n  created: function created() {\n    this.__setVirtualScrollSize();\n  },\n  beforeMount: function beforeMount() {\n    this.__onVirtualScrollEvt = debounce(this.__onVirtualScrollEvt, 70);\n    this.__setScroll = frameDebounce(setScroll);\n\n    this.__setVirtualScrollSize();\n  },\n  beforeDestroy: function beforeDestroy() {\n    clearTimeout(this.__preventNextScroll);\n  }\n};",{"version":3,"sources":["/home/witalo/go/src/github.com/witalok2/application/frontend/node_modules/quasar/src/mixins/virtual-scroll.js"],"names":["debounce","frameDebounce","aggBucketSize","sumFn","acc","h","getScrollDetails","parent","child","beforeRef","afterRef","horizontal","stickyStart","stickyEnd","parentCalc","window","document","scrollingElement","documentElement","propElSize","details","scrollStart","scrollViewSize","scrollMaxSize","offsetStart","offsetEnd","pageXOffset","scrollX","body","scrollLeft","innerWidth","clientWidth","scrollWidth","pageYOffset","scrollY","scrollTop","innerHeight","clientHeight","scrollHeight","el","previousElementSibling","nextElementSibling","parentRect","getBoundingClientRect","childRect","left","width","top","height","setScroll","scroll","scrollTo","sumSize","sizeAgg","size","from","to","lastTo","length","fromAgg","Math","floor","toAgg","total","slice","reduce","props","virtualScrollHorizontal","Boolean","virtualScrollSliceSize","type","Number","default","virtualScrollItemSize","virtualScrollStickySizeStart","virtualScrollStickySizeEnd","data","virtualScrollSliceRange","watch","__setVirtualScrollSize","methods","toIndex","scrollEl","__getVirtualScrollTarget","nodeType","__setVirtualScrollSliceRange","__getVirtualScrollEl","$refs","before","after","min","virtualScrollLength","max","parseInt","prevToIndex","__onVirtualScrollEvt","scrollDetails","scrollMaxStart","listLastIndex","prevScrollStart","virtualScrollSizesAgg","listOffset","j","virtualScrollSizes","offset","align","ceil","virtualScrollSliceSizeComputed","__emitScroll","rangeChanged","virtualScrollPaddingBefore","virtualScrollPaddingAfter","$nextTick","contentEl","content","children","i","index","diff","posStart","posEnd","scrollPosition","__setScroll","__resetVirtualScroll","defaultSize","Array","isArray","oldVirtualScrollSizesLength","jMax","iMax","push","__padVirtualScroll","tag","paddingSize","staticClass","key","ref","style","attrs","colspan","$listeners","$emit","direction","created","beforeMount","beforeDestroy","clearTimeout","__preventNextScroll"],"mappings":"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","sourcesContent":["import debounce from '../utils/debounce.js'\nimport frameDebounce from '../utils/frame-debounce.js'\n\nconst aggBucketSize = 1000\n\nfunction sumFn (acc, h) {\n  return acc + h\n}\n\nfunction getScrollDetails (\n  parent,\n  child,\n  beforeRef,\n  afterRef,\n  horizontal,\n  stickyStart,\n  stickyEnd\n) {\n  const\n    parentCalc = parent === window ? document.scrollingElement || document.documentElement : parent,\n    propElSize = horizontal === true ? 'offsetWidth' : 'offsetHeight',\n    details = {\n      scrollStart: 0,\n      scrollViewSize: -stickyStart - stickyEnd,\n      scrollMaxSize: 0,\n      offsetStart: -stickyStart,\n      offsetEnd: -stickyEnd\n    }\n\n  if (horizontal === true) {\n    if (parent === window) {\n      details.scrollStart = window.pageXOffset || window.scrollX || document.body.scrollLeft || 0\n      details.scrollViewSize += window.innerWidth\n    }\n    else {\n      details.scrollStart = parentCalc.scrollLeft\n      details.scrollViewSize += parentCalc.clientWidth\n    }\n    details.scrollMaxSize = parentCalc.scrollWidth\n  }\n  else {\n    if (parent === window) {\n      details.scrollStart = window.pageYOffset || window.scrollY || document.body.scrollTop || 0\n      details.scrollViewSize += window.innerHeight\n    }\n    else {\n      details.scrollStart = parentCalc.scrollTop\n      details.scrollViewSize += parentCalc.clientHeight\n    }\n    details.scrollMaxSize = parentCalc.scrollHeight\n  }\n\n  if (beforeRef !== void 0) {\n    for (let el = beforeRef.previousElementSibling; el !== null; el = el.previousElementSibling) {\n      details.offsetStart += el[propElSize]\n    }\n  }\n  if (afterRef !== void 0) {\n    for (let el = afterRef.nextElementSibling; el !== null; el = el.nextElementSibling) {\n      details.offsetEnd += el[propElSize]\n    }\n  }\n\n  if (child !== parent) {\n    const\n      parentRect = parentCalc.getBoundingClientRect(),\n      childRect = child.getBoundingClientRect()\n\n    if (horizontal === true) {\n      details.offsetStart += childRect.left - parentRect.left\n      details.offsetEnd -= childRect.width\n    }\n    else {\n      details.offsetStart += childRect.top - parentRect.top\n      details.offsetEnd -= childRect.height\n    }\n\n    if (parent !== window) {\n      details.offsetStart += details.scrollStart\n    }\n    details.offsetEnd += details.scrollMaxSize - details.offsetStart\n  }\n\n  return details\n}\n\nfunction setScroll (parent, scroll, horizontal) {\n  if (parent === window) {\n    if (horizontal === true) {\n      window.scrollTo(scroll, window.pageYOffset || window.scrollY || document.body.scrollTop || 0)\n    }\n    else {\n      window.scrollTo(window.pageXOffset || window.scrollX || document.body.scrollLeft || 0, scroll)\n    }\n  }\n  else {\n    parent[horizontal === true ? 'scrollLeft' : 'scrollTop'] = scroll\n  }\n}\n\nfunction sumSize (sizeAgg, size, from, to) {\n  if (from >= to) { return 0 }\n\n  const\n    lastTo = size.length,\n    fromAgg = Math.floor(from / aggBucketSize),\n    toAgg = Math.floor((to - 1) / aggBucketSize) + 1\n\n  let total = sizeAgg.slice(fromAgg, toAgg).reduce(sumFn, 0)\n\n  if (from % aggBucketSize !== 0) {\n    total -= size.slice(fromAgg * aggBucketSize, from).reduce(sumFn, 0)\n  }\n  if (to % aggBucketSize !== 0 && to !== lastTo) {\n    total -= size.slice(to, toAgg * aggBucketSize).reduce(sumFn, 0)\n  }\n\n  return total\n}\n\nexport default {\n  props: {\n    virtualScrollHorizontal: Boolean,\n\n    virtualScrollSliceSize: {\n      type: Number,\n      default: 30\n    },\n\n    virtualScrollItemSize: {\n      type: Number,\n      default: 24\n    },\n\n    virtualScrollStickySizeStart: {\n      type: Number,\n      default: 0\n    },\n\n    virtualScrollStickySizeEnd: {\n      type: Number,\n      default: 0\n    }\n  },\n\n  data () {\n    return {\n      virtualScrollSliceRange: { from: 0, to: 0 }\n    }\n  },\n\n  watch: {\n    virtualScrollHorizontal () {\n      this.__setVirtualScrollSize()\n    }\n  },\n\n  methods: {\n    scrollTo (toIndex) {\n      const scrollEl = this.__getVirtualScrollTarget()\n\n      if (scrollEl === void 0 || scrollEl === null || scrollEl.nodeType === 8) {\n        return\n      }\n\n      this.__setVirtualScrollSliceRange(\n        scrollEl,\n        getScrollDetails(\n          scrollEl,\n          this.__getVirtualScrollEl(),\n          this.$refs.before,\n          this.$refs.after,\n          this.virtualScrollHorizontal,\n          this.virtualScrollStickySizeStart,\n          this.virtualScrollStickySizeEnd\n        ),\n        Math.min(this.virtualScrollLength - 1, Math.max(0, parseInt(toIndex, 10) || 0)),\n        0,\n        this.prevToIndex > -1 && toIndex > this.prevToIndex ? 'end' : 'start'\n      )\n    },\n\n    __onVirtualScrollEvt () {\n      const scrollEl = this.__getVirtualScrollTarget()\n\n      if (scrollEl === void 0 || scrollEl === null || scrollEl.nodeType === 8) {\n        return\n      }\n\n      const\n        scrollDetails = getScrollDetails(\n          scrollEl,\n          this.__getVirtualScrollEl(),\n          this.$refs.before,\n          this.$refs.after,\n          this.virtualScrollHorizontal,\n          this.virtualScrollStickySizeStart,\n          this.virtualScrollStickySizeEnd\n        ),\n        scrollMaxStart = scrollDetails.scrollMaxSize - Math.max(scrollDetails.scrollViewSize, scrollDetails.offsetEnd),\n        listLastIndex = this.virtualScrollLength - 1\n\n      if (this.prevScrollStart === scrollDetails.scrollStart) {\n        return\n      }\n      this.prevScrollStart = void 0\n\n      if (scrollMaxStart > 0 && scrollDetails.scrollStart >= scrollMaxStart) {\n        this.__setVirtualScrollSliceRange(\n          scrollEl,\n          scrollDetails,\n          this.virtualScrollLength - 1,\n          scrollMaxStart - this.virtualScrollSizesAgg.reduce(sumFn, 0)\n        )\n\n        return\n      }\n\n      let\n        toIndex = 0,\n        listOffset = scrollDetails.scrollStart - scrollDetails.offsetStart\n\n      for (let j = 0; listOffset >= this.virtualScrollSizesAgg[j] && toIndex < listLastIndex; j++) {\n        listOffset -= this.virtualScrollSizesAgg[j]\n        toIndex += aggBucketSize\n      }\n\n      while (listOffset > 0 && toIndex < listLastIndex) {\n        listOffset -= this.virtualScrollSizes[toIndex]\n        toIndex++\n      }\n\n      this.__setVirtualScrollSliceRange(\n        scrollEl,\n        scrollDetails,\n        toIndex,\n        listOffset\n      )\n    },\n\n    __setVirtualScrollSliceRange (scrollEl, scrollDetails, toIndex, offset, align) {\n      let\n        from = Math.max(0, Math.ceil(toIndex - (align === void 0 ? 3 : 2) * this.virtualScrollSliceSizeComputed / 6)),\n        to = from + this.virtualScrollSliceSizeComputed\n\n      if (to > this.virtualScrollLength) {\n        to = this.virtualScrollLength\n        from = Math.max(0, to - this.virtualScrollSliceSizeComputed)\n      }\n\n      this.__emitScroll(toIndex)\n\n      const rangeChanged = from !== this.virtualScrollSliceRange.from || to !== this.virtualScrollSliceRange.to\n\n      if (rangeChanged === false && align === void 0) {\n        return\n      }\n\n      if (rangeChanged === true) {\n        this.virtualScrollSliceRange = { from, to }\n        this.virtualScrollPaddingBefore = sumSize(this.virtualScrollSizesAgg, this.virtualScrollSizes, 0, from)\n        this.virtualScrollPaddingAfter = sumSize(this.virtualScrollSizesAgg, this.virtualScrollSizes, to, this.virtualScrollLength)\n      }\n\n      this.$nextTick(() => {\n        if (rangeChanged === true) {\n          const contentEl = this.$refs.content\n\n          if (contentEl !== void 0) {\n            const children = contentEl.children\n\n            for (let i = children.length - 1; i >= 0; i--) {\n              const\n                index = from + i,\n                diff = children[i][this.virtualScrollHorizontal === true ? 'offsetWidth' : 'offsetHeight'] - this.virtualScrollSizes[index]\n\n              if (diff !== 0) {\n                this.virtualScrollSizes[index] += diff\n                this.virtualScrollSizesAgg[Math.floor(index / aggBucketSize)] += diff\n              }\n            }\n          }\n        }\n\n        const\n          posStart = this.virtualScrollSizes.slice(from, toIndex).reduce(sumFn, scrollDetails.offsetStart + this.virtualScrollPaddingBefore),\n          posEnd = posStart + this.virtualScrollSizes[toIndex]\n\n        let scrollPosition = posStart + offset\n\n        if (align !== void 0) {\n          scrollPosition = scrollDetails.scrollStart < posStart && posEnd < scrollDetails.scrollStart + scrollDetails.scrollViewSize\n            ? scrollDetails.scrollStart\n            : (align === 'end' ? posEnd - scrollDetails.scrollViewSize : posStart)\n        }\n\n        this.prevScrollStart = scrollPosition\n\n        this.__setScroll(\n          scrollEl,\n          scrollPosition,\n          this.virtualScrollHorizontal\n        )\n      })\n    },\n\n    __resetVirtualScroll (toIndex) {\n      const defaultSize = this.virtualScrollItemSize\n\n      if (Array.isArray(this.virtualScrollSizes) === false) {\n        this.virtualScrollSizes = []\n      }\n\n      const oldVirtualScrollSizesLength = this.virtualScrollSizes.length\n\n      this.virtualScrollSizes.length = this.virtualScrollLength\n\n      for (let i = this.virtualScrollLength - 1; i >= oldVirtualScrollSizesLength; i--) {\n        this.virtualScrollSizes[i] = defaultSize\n      }\n\n      const jMax = Math.floor((this.virtualScrollLength - 1) / aggBucketSize)\n      this.virtualScrollSizesAgg = []\n      for (let j = 0; j <= jMax; j++) {\n        let size = 0\n        const iMax = Math.min((j + 1) * aggBucketSize, this.virtualScrollLength)\n        for (let i = j * aggBucketSize; i < iMax; i++) {\n          size += this.virtualScrollSizes[i]\n        }\n        this.virtualScrollSizesAgg.push(size)\n      }\n\n      this.prevToIndex = -1\n      this.prevScrollStart = void 0\n\n      if (toIndex >= 0) {\n        this.$nextTick(() => {\n          this.scrollTo(toIndex)\n        })\n      }\n      else {\n        this.virtualScrollPaddingBefore = sumSize(this.virtualScrollSizesAgg, this.virtualScrollSizes, 0, this.virtualScrollSliceRange.from)\n        this.virtualScrollPaddingAfter = sumSize(this.virtualScrollSizesAgg, this.virtualScrollSizes, this.virtualScrollSliceRange.to, this.virtualScrollLength)\n\n        this.__onVirtualScrollEvt()\n      }\n    },\n\n    __setVirtualScrollSize () {\n      if (this.virtualScrollHorizontal === true) {\n        this.virtualScrollSliceSizeComputed = typeof window === 'undefined'\n          ? this.virtualScrollSliceSize\n          : Math.max(this.virtualScrollSliceSize, Math.ceil(window.innerWidth / this.virtualScrollItemSize * 2))\n      }\n      else {\n        this.virtualScrollSliceSizeComputed = typeof window === 'undefined'\n          ? this.virtualScrollSliceSize\n          : Math.max(this.virtualScrollSliceSize, Math.ceil(window.innerHeight / this.virtualScrollItemSize * 2))\n      }\n    },\n\n    __padVirtualScroll (h, tag, content) {\n      const paddingSize = this.virtualScrollHorizontal === true ? 'width' : 'height'\n\n      return [\n        tag === 'tbody'\n          ? h(tag, {\n            staticClass: 'q-virtual-scroll__padding',\n            key: 'before',\n            ref: 'before'\n          }, [\n            h('tr', [\n              h('td', {\n                style: { [paddingSize]: `${this.virtualScrollPaddingBefore}px` },\n                attrs: { colspan: '100%' }\n              })\n            ])\n          ])\n          : h(tag, {\n            staticClass: 'q-virtual-scroll__padding',\n            key: 'before',\n            ref: 'before',\n            style: { [paddingSize]: `${this.virtualScrollPaddingBefore}px` }\n          }),\n\n        h(tag, {\n          staticClass: 'q-virtual-scroll__content',\n          key: 'content',\n          ref: 'content'\n        }, content),\n\n        tag === 'tbody'\n          ? h(tag, {\n            staticClass: 'q-virtual-scroll__padding',\n            key: 'after',\n            ref: 'after'\n          }, [\n            h('tr', [\n              h('td', {\n                style: { [paddingSize]: `${this.virtualScrollPaddingAfter}px` },\n                attrs: { colspan: '100%' }\n              })\n            ])\n          ])\n          : h(tag, {\n            staticClass: 'q-virtual-scroll__padding',\n            key: 'after',\n            ref: 'after',\n            style: { [paddingSize]: `${this.virtualScrollPaddingAfter}px` }\n          })\n      ]\n    },\n\n    __emitScroll (index) {\n      if (this.prevToIndex !== index) {\n        this.$listeners['virtual-scroll'] !== void 0 && this.$emit('virtual-scroll', {\n          index,\n          from: this.virtualScrollSliceRange.from,\n          to: this.virtualScrollSliceRange.to - 1,\n          direction: index < this.prevToIndex ? 'decrease' : 'increase'\n        })\n\n        this.prevToIndex = index\n      }\n    }\n  },\n\n  created () {\n    this.__setVirtualScrollSize()\n  },\n\n  beforeMount () {\n    this.__onVirtualScrollEvt = debounce(this.__onVirtualScrollEvt, 70)\n    this.__setScroll = frameDebounce(setScroll)\n    this.__setVirtualScrollSize()\n  },\n\n  beforeDestroy () {\n    clearTimeout(this.__preventNextScroll)\n  }\n}\n"]}]}